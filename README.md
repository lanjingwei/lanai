# LANAI - 手机端AI问答助手

这是一个简洁的手机端AI问答助手应用，模仿GPT对话界面，无需登录注册即可使用。

## 功能特点

- 响应式设计，适配手机和桌面设备
- 简洁美观的聊天界面
- Markdown格式支持
- 打字动画效果
- 基于大型语言模型的AI回答
- 实时API连接状态指示
- 支持多种酒馆-Flash模型选择
- 改进的错误处理和调试信息
- **新增**：全局预设功能，设定AI角色和行为
- **新增**：历史记录功能，保存并恢复以前的对话
- **新增**：优化的移动端界面，更加美观易用

## 技术实现

- 纯前端实现，使用HTML, CSS和JavaScript
- 调用酒馆-Flash API提供AI对话能力
- 支持Markdown格式化
- 自适应界面设计
- 采用更可靠的API响应处理机制
- 多重错误处理和响应修复机制
- 本地存储保存历史对话和预设
- 通知系统提供操作反馈

## 使用方法

1. 直接在浏览器中打开`index.html`文件
2. 在顶部可以看到应用名称"LANAI"和API连接状态
3. 点击右上角的按钮访问全局预设和历史记录功能
4. 在输入框左侧选择要使用的模型
5. 在输入框中输入问题
6. 点击发送按钮或按Enter键发送消息
7. 等待AI回复

## 全局预设

全局预设功能允许您为AI设定角色和行为：
- 点击顶部栏右侧的滑块图标打开预设窗口
- 输入预设内容，如"你是一位专业的健康顾问"
- 点击保存，预设会在所有新对话中自动生效
- 预设会保存在本地，下次打开应用时仍然有效

## 历史记录

历史记录功能允许您保存和恢复以前的对话：
- 系统会自动保存每次对话
- 点击顶部栏右侧的时钟图标查看历史记录
- 点击任意历史记录项可恢复该对话
- 可以随时清空历史记录

## API信息

- API地址: https://grokyellow.96ai.top/v1/chat/completions
- API密钥: sk-123456
- 支持模型: 
  - 酒馆-Flash-Thinking (默认)
  - 酒馆-Flash-NoThinking
  - 酒馆-Flash

## 本地部署

只需将三个文件（index.html, style.css, script.js）部署到任意Web服务器上即可使用。

## 常见问题与解决方案

### API连接问题

如果遇到"Unexpected non-whitespace character after JSON"错误，可能是由以下原因造成：

1. API响应格式与预期不符
2. API服务器返回了非标准JSON格式的数据
3. 网络连接不稳定导致响应数据损坏

本应用已使用多重机制来应对这些问题：
- 使用`response.text()`先获取原始响应再手动解析
- 使用JSON格式提取和修复算法清理响应数据
- 支持多种数据提取回退方法
- 添加详细的错误日志和状态指示
- 使用XMLHttpRequest替代Fetch，提高兼容性

### 模型选择

不同模型有不同的特点：
- 酒馆-Flash-Thinking: 回答更全面，有思考过程
- 酒馆-Flash-NoThinking: 回答简洁，无思考过程
- 酒馆-Flash: 通用模型

## 注意事项

- 此应用为纯前端实现，API密钥直接暴露在前端代码中，仅供学习和测试使用
- 生产环境中应使用后端服务器转发API请求，以保护API密钥
- API可能有使用限制，请遵循相关服务条款
- 历史记录和预设保存在浏览器本地存储中，清除浏览器数据会导致这些信息丢失

## 自定义

可以修改`script.js`中的常量来更改API地址、密钥：

```javascript
const API_URL = 'https://grokyellow.96ai.top/v1/chat/completions';
const API_KEY = 'sk-123456';
```

## 界面预览

在手机上打开时，界面会自动适配屏幕大小，提供流畅的用户体验。顶部状态栏会显示API连接状态，绿色表示连接正常，红色表示连接异常，黄色表示正在连接中。 